<!DOCTYPE html>
<html>
<head>

    <!-- Meta info -->
		<meta charset="utf-8">
		<meta name="shortauthor" content="Diego Passos"/>
		<meta name="shorttitle" content="HTTP (II), FTP, E-mail, P2P"/>
		<meta name="shortevent" content="Redes de Computadores"/>
		<title>Redes de Computadores: Aula 6</title>

		<!-- Math support -->
		<script type="text/x-mathjax-config">
		MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
			MathJax.InputJax.TeX.Definitions.number = /^(?:[0-9]+(?:\.[0-9]{3})*(?:\{,\}[0-9]*)*|\{,\}[0-9]+)/
		});
		</script>
		<script src="js/plotly-latest.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
		<script src="../../../../../MathJax-2.6-latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
		<script type="text/javascript" src="../template/js/dz_pre.js"></script>

		<!-- Fonts -->
		<link href='https://fonts.googleapis.com/css?family=Lora:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
		<link href='../../../../../Fonts/Lora/lora.css' rel='stylesheet' type='text/css'>

		<!-- CSS -->
		<link href='../template/css/template.css' id="template" rel='stylesheet' type='text/css'>
		<link href='../template/css/presentationSpecific.css' id="presentationSpecific" rel='stylesheet' type='text/css'>


		<!-- Javascript -->
		<script type="text/javascript" src="../template/js/audio.js"></script>
		<script src="js/term.js" charset="utf-8"></script>
    <script src="js/termcast.js" charset="utf-8"></script>
</head>

<body>
    <!-- Audio handlers -->
	<!--<audio src="audio/La.wav" id="La.wav" preload="auto"></audio>-->

    <!-- Title Slide -->
	<section>

        <div class="slideContent">
            <h1 class="title">Aula 6 - HTTP (Cookies, Web Caches), FTP, E-mail, P2P</h1>
            <h2 class="author">Diego Passos</h2>
            <h4 class="institution">Universidade Federal Fluminense</h4>
            <h3 class="date">Redes de Computadores</h3>
        </div>

	<br>
	<br>
	<div style="width: 30%; float: right; padding-right: 2%;">
	<p style="font-size: 18px; text-align: right;">Material adaptado a partir dos slides originais de J.F Kurose and K.W. Ross.</p>
	</div>
	</section>

    <section class="secao">
    <div class="slideContent">
        Cookies
    </div>
    </section>

    <section>
    <h1>Estado do Usuário no Servidor: Cookies</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li>Muitos <i>sites</i> utilizam cookies.</li>
                <li><b>Quatro componentes:</b>
                <ol>
                    <li>Entrada de cabeçalho relativa aos cookies na mensagem de resposta HTTP.</li>
                    <li>Entrada de cabeçalho relativa aos cookies na mensagem de requisição HTTP.</li>
                    <li>Arquivo de cookies mantido no <i>host</i> do usuário e gerenciado pelo <i>browser</i>.</li>
                    <li>Base de dados no <i>backend</i> do <i>site</i>.</li>
                </ol></li>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <ul>
                <li><b>Exemplo:</b>
                <ul>
                    <li>Susan sempre acessa a Internet de seu PC.</li>
                    <li>Visita site específico de comércio eletrônico pela primeira vez.</li>
                    <li>Quando requisição HTTP inicial chega ao servidor, <i>site</i> cria:
                    <ul>
                        <li>ID único.</li>
                        <li>Entrada na base de dados associada ao ID.</li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
    </div>
    </section>

    <section>
    <h1>Cookies: Mantendo Estado</h1>
    <div class="slideContent">
        <center>
            <img src="imagens/Cookies.svg" style="width: 70%;"/>
        </center>
    </div>
    </section>

    <section>
    <h1>Cookies (Mais)</h1>
    <div class="slideContent">
        <div style="height: 250px;">
            <div class="column" style="width: 50%;">
                <ul>
                    <li><b>Para que cookies podem ser utilizados:</b>
                    <ul>
                        <li>Autorização.</li>
                        <li>&ldquo;Carrinhos de compra&rdquo;.</li>
                        <li>Recomendações.</li>
                        <li>Estado da sessão do usuário (<i>e.g.</i>, webmail).</li>
                    </ul></li>
                </ul>
            </div>
            <div class="column" style="width: 50%;">
                <center>
                    <div class="block" style="width:550px;">
                        <div class="blockTitle" style="width: 100%;">
                            <p>Nota: cookies e privacidade</p>
                        </div>
                        <div class="blockBody">
                            <ul>
                                <li>Cookies permitem que <i>sites</i> aprendam muito sobre você.</li>
                                <li>Você pode fornecer nome e e-mail para <i>sites</i>.</li>
                            </ul>
                        </div>
                    </div>
                </center>
            </div>
        </div>
        <br>
        <div>
        <ul>
            <li><b>Como manter &ldquo;estado&rdquo;:</b>
            <ul>
                <li>Sistemas finais mantém estado no transmissor, receptor ao longo de várias transações.</li>
                <li>Cookies: mensagens HTTP carregam estado.</li>
            </ul></li>
        </ul>
        </div>
    </div>
    </section>

    <section class="secao">
    <div class="slideContent">
        Web Caches
    </div>
    </section>

    <section>
    <h1>Web Caches (Servidores Proxy)</h1>
    <div class="slideContent">
        <ul>
            <li><b>Objetivo:</b> satisfazer requisição do cliente sem envolver servidor original do conteúdo.</li>
        </ul>

        <div class="column" style="width: 45%;">
            <ul>
                <li>Usuário configura <i>browser</i>: acessos web via cache.</li>
                <li><i>Browser</i> envia todas as requisições HTTP ao cache.
                <ul>
                    <li>Objetos em cache: retornados imediatamente.</li>
                    <li>Caso contrário, cache requisita objeto do servidor, retorna objeto ao cliente.</li>
                </ul></li>
            </ul>
        </div>

        <div class="column" style="width: 55%;">
            <center>
                <img src="imagens/WebCacheProxy.svg" style="width: 90%;"/>
            </center>
        </div>
    </div>
    </section>

    <section>
    <h1>Mais sobre Web Caches</h1>
    <div class="slideContent">
        <div class="column" style="width: 45%;">
            <ul>
                <li>Cache age tanto como servidor, quanto como cliente.
                <ul>
                    <li>Servidor para a requisição original.</li>
                    <li>Cliente para o servidor original do conteúdo.</li>
                </ul></li>
                <li>Tipicamente, cache é instalado na rede de acesso ou pelo ISP.</li>
            </ul>
        </div>

        <div class="column" style="width: 55%;">
            <ul>
                <li><b>Por que usar um web cache?</b>
                <ul>
                    <li>Reduzir o <span class="alert">tempo de resposta</span> para o cliente.</li>
                    <li>Reduzir o <span class="alert">tráfego no enlace de acesso</span> da instituição.</li>
                    <li>Internet densamente populada por cache: permite que provedores de conteúdo &ldquo;pobres&rdquo; entregue conteúdo de forma efetiva.
                    <ul>
                        <li>P2P também.</li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
    </div>
    </section>

    <section>
    <h1>Web Cache: Exemplo</h1>
    <div class="slideContent">
        <div class="column" style="width: 58%;">
            <ul>
                <li><b>Hipóteses:</b>
                <ul>
                    <li>Tamanho médio dos objetos: 100 kb.</li>
                    <li>Taxa média de requisição do <i>browsers</i>: 15/s.
                    <ul>
                        <li>Taxa média para os <i>browsers</i>: 1,5 Mb/s.</li>
                    </ul></li>
                    <li>RTT do roteador de borda para qualquer servidor: 2s.</li>
                    <li>Capacidade do enlace de acesso: 1,54 Mb/s.</li>
                </ul></li>
                <li><b>Consequências:</b>
                <ul>
                    <li>Utilização da LAN: 0,15%.</li>
                    <li>Utilização do enlace de acesso: <span class="alert">99%</span>!</li>
                    <li>Atraso total = Atraso da Internet + atraso do roteador de borda + atraso da LAN.
                    <ul>
                        <li>= 2s + minutos + <span class="math inline">\(\mu s\)</span></li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
        <div class="column" style="width: 42%;">
            <center>
                <img src="imagens/WebCacheExemplo.svg" style="width: 80%;"/>
            </center>
        </div>
    </div>
    </section>

    <section>
    <h1>Web Cache: Exemplo (Enlace de Maior Capacidade)</h1>
    <div class="slideContent">
        <div style="height: 520px;">
        <div class="column" style="width: 58%;">
            <ul>
                <li><b>Hipóteses:</b>
                <ul>
                    <li>Tamanho médio dos objetos: 100 kb.</li>
                    <li>Taxa média de requisição do <i>browsers</i>: 15/s.
                    <ul>
                        <li>Taxa média para os <i>browsers</i>: 1,5 Mb/s.</li>
                    </ul></li>
                    <li>RTT do roteador de borda para qualquer servidor: 2s.</li>
                    <li>Capacidade do enlace de acesso: <strike> 1,54 </strike> 154 Mb/s.</li>
                </ul></li>
                <li><b>Consequências:</b>
                <ul>
                    <li>Utilização da LAN: 0,15%.</li>
                    <li>Utilização do enlace de acesso: <span class="alert"><strike> 99% </strike></span> 0,99%.</li>
                    <li>Atraso total = Atraso da Internet + atraso do roteador de borda + atraso da LAN.
                    <ul>
                        <li>= 2s + <strike>minutos</strike> ms + <span class="math inline">\(\mu s\)</span></li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
        <div class="column" style="width: 42%;">
            <center>
                <img src="imagens/WebCacheExemplo2.svg" style="width: 80%;"/>
            </center>
        </div>
        </div>
        <ul>
            <li><b>Custo:</b> aumento na capacidade do enlace de acesso (não é barato!).</li>
        </ul>
    </div>
    </section>

    <section>
    <h1>Web Cache: Exemplo (Solução com Web Cache, I)</h1>
    <div class="slideContent">
        <div style="height: 480px;">
        <div class="column" style="width: 58%;">
            <ul>
                <li><b>Hipóteses:</b>
                <ul>
                    <li>Tamanho médio dos objetos: 100 kb.</li>
                    <li>Taxa média de requisição do <i>browsers</i>: 15/s.
                    <ul>
                        <li>Taxa média para os <i>browsers</i>: 1,5 Mb/s.</li>
                    </ul></li>
                    <li>RTT do roteador de borda para qualquer servidor: 2s.</li>
                    <li>Capacidade do enlace de acesso: 1,54 Mb/s.</li>
                </ul></li>
                <li><b>Consequências:</b>
                <ul>
                    <li>Utilização da LAN: 0,15%.</li>
                    <li>Utilização do enlace de acesso: <span class="alert">?</span></li>
                    <li>Atraso total = <span class="alert">?</span></li>
                </ul></li>
            </ul>
            <center>
                <div style="width: 60%;">
                <span class="alert">Como calcular utilização do enlace de acesso, atraso?</span>
                </div>
            </center>
        </div>
        <div class="column" style="width: 42%;">
            <center>
                <img src="imagens/WebCacheExemplo3.svg" style="width: 80%;"/>
            </center>
        </div>
        </div>
        <ul>
            <li><b>Custo:</b> web cache (barato!).</li>
        </ul>
    </div>
    </section>

    <section>
    <h1>Web Cache: Exemplo (Solução com Web Cache, II)</h1>
    <div class="slideContent">
        <div class="column" style="width: 58%;">
            <ul>
                <li><b>Calculando a utilização do enlace de acesso e atraso com cache.</b>
                <ul>
                    <li>Assuma que a taxa de acerto (<i>hit rate</i>) é 0,4.
                    <ul>
                        <li>40% das requisições satisfeitas no cache, 60% precisam ir à origem.</li>
                    </ul></li>
                    <li>Utilização do enlace de acesso:
                    <ul>
                        <li>60% das requisições usam o enlace.</li>
                        <li><span class="math inline">\(0{,}6\times 1{,}5 = 0,9\)</span>&nbsp;Mb/s de tráfego.</li>
                        <li>Utilização: <span class="math inline">\(\frac{0{,}9}{1{,}54} = 0{,}58\)</span>.</li>
                    </ul></li>
                    <li>Atraso total:
                    <ul>
                        <li><span class="math inline">\(0{,}6\times\)</span> (atraso da origem) + <span class="math inline">\(0{,}4\times\)</span> (atraso do cache).</li>
                        <li><span class="math inline">\(0{,}6\times 2{,}01 + 0{,}4\times (ms) \approx 1{,}2\)</span> s.</li>
                        <li>Menos que com enlace de 154 Mb/s (e mais barato!)</li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
        <div class="column" style="width: 42%;">
            <center>
                <img src="imagens/WebCacheExemplo3.svg" style="width: 80%;"/>
            </center>
        </div>
    </div>
    </section>

    <section>
    <h1>GET Condicional</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li><b>Objetivo:</b> não enviar objeto se cache tem versão atualizada.
                <ul>
                    <li>Não há atraso de envio do objeto.</li>
                    <li>Reduz utilização do enlace de acesso.</li>
                </ul></li>
                <li>Cache: especifica data da cópia local na requisição HTTP.</li>
                <br>
                <center>
                    <tt>If-modified-since: &lt;data&gt;</tt>
                </center>
                <br>
                <li>Servidor: resposta não contém objeto se cópia está atualizada.</li>
                <br>
                <center>
                    <tt>HTTP/1.0 304 Not Modified</tt>
                </center>
                <br>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <center>
                <img src="imagens/ConditionalGET.svg" style="width: 80%;"/>
            </center>
        </div>
    </div>
    </section>

		<section>
		<h1>GET Condicional: Exemplo</h1>
		<div class="slideContent">
		  <div class="column" style="width: 50%;">
				<div id="termcastGETCondicional" style="margin-left: 3px;"></div>
		  </div>
			<div class="column" style="width: 50%;">
			  <ul>
			    <li>Primeira requisição:
			    <ul>
			      <li>Data especificada posterior à última modificação do objeto.</li>
			      <li>Servidor envia cabeçalhos, mas não conteúdo.</li>
			      <li>Código 304 (<tt>Not Modified</tt>).</li>
			    </ul></li>
			    <li>Segunda requisição:
			    <ul>
			      <li>Data de um dia antes.</li>
			      <li>Servidor envia objeto, como em um <tt>GET</tt> &ldquo;normal&rdquo;.</li>
			    </ul></li>
			    <li><b>Detalhe:</b> versão 1.1 do HTTP especificada nas requisições.
			    <ul>
			      <li>Resultado: conexão persistente utilizada por padrão.</li>
						<li>Ambas as requisições feitas em uma única conexão.</li>
			    </ul></li>
			  </ul>
			</div>
		</div>
		</section>

		<script type="text/javascript">
        var TermCast1;
        DzAddPostInitFunction(function() {

            TermCast1 = new TermCast(document.getElementById('termcastGETCondicional'), 'terminalSessions/GetCondicional.json');
        });
    </script>

    <section class="secao">
    <div class="slideContent">
        FTP
    </div>
    </section>

    <section>
    <h1>FTP: <i>File Transfer Protocol</i></h1>
    <div class="slideContent">
        <center>
            <img src="imagens/FTP.svg" style="width: 50%;"/>
        </center>
        <br>
        <ul>
            <li>Transfere arquivos de/para <i>host</i> remoto.</li>
            <li>Arquitetura Cliente-Servidor.
            <ul>
                <li><span class="alert">Cliente:</span> lado que inicia transferência (seja de ou para <i>host</i> remoto).</li>
                <li><span class="alert">Servidor:</span> <i>host</i> remoto.</li>
            </ul></li>
            <li>FTP: RFC 959.</li>
            <li>Servidor FTP: escuta, por padrão, na porta 21.</li>
        </ul>
    </div>
    </section>

    <section>
    <h1>FTP: Conexões de Controle e Dados Separadas</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li>Cliente FTP contacta servidor na porta 21, usando TCP.</li>
                <li>Cliente autorizado através da conexão de controle.</li>
                <li>Cliente navega diretórios remotos, envia comandos pela conexão de controle.</li>
                <li>Quando servidor recebe comando de transferência da arquivo, <span class="alert">servidor</span> abre 2ª conexão TCP (para arquivo) para o cliente.</li>
                <li>Depois de transferir arquivo, servidor fecha conexão de dados.</li>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <center>
                <img src="imagens/FTPOutOfBand.svg" style="width: 80%;"/>
            </center>
            <br>
            <ul>
                <li>Servidor abre nova conexão TCP para cada arquivo enviado.</li>
                <li>Conexão dedicada para controle: comunicação <span class="alert">&ldquo;fora-de-banda&rdquo;</span>.</li>
                <li>Servidor FTP precisa manter &ldquo;estado&rdquo;.
                <ul>
                    <li>Diretório corrente, autenticação.</li>
                </ul></li>
            </ul>
        </div>
    </div>
    </section>

    <section>
    <h1>FTP: Comandos e Respostas</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li><b>Exemplos de comandos:</b>
                <ul>
                    <li>Enviados como texto ASCII pela conexão de controle.</li>
                    <li><tt>USER username</tt>.</li>
                    <li><tt>PASS password</tt>.</li>
                    <li><tt>LIST</tt>.
                    <ul>
                        <li>Retorna lista dos arquivos no diretório corrente.</li>
                    </ul></li>
                    <li><tt>RETR filename</tt>.
                    <ul>
                        <li><i>Download</i> do arquivo.</li>
                    </ul></li>
                    <li><tt>STOR filename</tt>.
                    <ul>
                        <li><i>Upload</i> do arquivo.</li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <ul>
                <li><b>Exemplos de códigos de retorno:</b>
                <ul>
                    <li>Código de <i>status</i> e descrição (como no HTTP).</li>
                    <li><tt>331 Username OK, password required</tt>.</li>
                    <li><tt>125 data connection already open; transfer starting</tt>.</li>
                    <li><tt>425 Can't open data connection</tt>.</li>
                    <li><tt>452 Error writing file</tt>.</li>
                </ul></li>
            </ul>
        </div>
    </div>
    </section>

    <section class="secao">
    <div class="slideContent">
        E-mail
    </div>
    </section>

    <section>
    <h1>E-mail</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li><b>Três grandes componentes:</b>
                <ul>
                    <li><i>User agents</i>.</li>
                    <li>Servidores de e-mail.</li>
                    <li>SMTP: <i>Simple Mail Transfer Protocol</i>.</li>
                </ul></li>
                <li><b>User agent</b>:
                <ul>
                    <li>Também conhecido como &ldquo;leitor de e-mail&rdquo;.</li>
                    <li>Criação, edição, leitura de mensagens de e-mail.</li>
                    <li><i>e.g.</i>, Outlook, Thunderbird, cliente de e-mail do iPhone.</li>
                    <li>Mensagens enviadas, recebidas armazenadas no servidor.</li>
                </ul></li>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <center>
                <img src="imagens/ServicoDeEmail.svg" style="width: 70%;"/>
            </center>
        </div>
    </div>
    </section>

    <section>
    <h1>E-mail: Servidores de E-mail</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <br>
            <br>
            <ul>
                <li><b>Servidores de e-mail:</b>
                <ul>
                    <li><span class="alert">Caixa de e-mail:</span> contém mensagens que chegam para o usuário.</li>
                    <li><span class="alert">Fila de mensagens:</span> contém mensagens a serem enviadas.</li>
                    <li><span class="alert">Protocolo SMTP:</span> comunicação entre servidores de e-mail para envio de mensagens.
                    <ul>
                        <li>Cliente: servidor que envia mensagem.</li>
                        <li>Servidor: servidor que recebe mensagem.</li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <center>
                <img src="imagens/ServicoDeEmail.svg" style="width: 70%;"/>
            </center>
    </div>
    </section>

    <section>
    <h1>E-mail: SMTP [RFC 2821]</h1>
    <div class="slideContent">
        <ul>
            <li>Utiliza TCP para transferir mensagens de forma confiável entre cliente e servidor, porta 25.</li>
            <li>Transferência direta: do servidor do destinatário diretamente para o servidor do remetente.</li>
            <li>Protocolo em três fases:
            <ul>
                <li><i>Handshaking</i> (apresentação).</li>
                <li>Transferência da mensagens.</li>
                <li>Encerramento.</li>
            </ul></li>
            <li>Interação do tipo comando/resposta (similar ao FTP, HTTP).
            <ul>
                <li><span class="alert">Comandos:</span> texto ASCII.</li>
                <li><span class="alert">Resposta:</span> código de <i>status</i> e descrição.</li>
            </ul></li>
            <li>Mensagens necessariamente em ASCII de 7 bits.</li>
        </ul>
    </div>
    </section>

    <section>
    <h1>Cenário: Alice Envia Mensagem para Bob</h1>
    <div class="slideContent">
        <div style="height: 280px;">
            <div class="column" style="width: 50%;">
                <ol>
                    <li>Alice usa <i>user agent</i> para criar mensagem para <tt>bob@someschool.edu</tt>.</li>
                    <li>O <i>user agent</i> de Alice envia mensagem ao seu servidor de e-mail (de Alice); mensagem é enfileirada.</li>
                    <li>No servidor de Alice, lado cliente do SMTP abre conexão TCP para o servidor de Bob.</li>
                </ol>
            </div>
            <div class="column" style="width: 50%;">
                <ol start="4">
                    <li>Mensagem de Alice é enviada pela conexão TCP.</li>
                    <li>Servidor de e-mail de Bob coloca mensagem na caixa de entrada de Bob.</li>
                    <li>Bob usa seu <i>user agent</i> para ler a mensagem.</li>
                </ol>
            </div>
        </div>
        <br>
        <center>
            <img src="imagens/EnvioDeEmail.svg" style="width: 70%;"/>
        </center>
    </div>
    </section>

    <section>
    <h1>Exemplo de Interação SMTP</h1>
    <div class="slideContent">
        <center>
            <div style="text-align: left; width: 80%;" >
            <tt style="text-align: left;">
                S: 220 hamburger.edu<br>
                C: HELO crepes.fr<br>
                S: 250 Hello crepes.fr, pleased to meet you<br>
                C: MAIL FROM: &lt;alice@crepes.fr&gt;<br>
                S: 250 alice@crepes.fr... Sender ok<br>
                C: RCPT TO: &lt;bob@hamburger.edu&gt;<br>
                S: 250 bob@hamburger.edu ... Recipient ok<br>
                C: DATA<br>
                S: 354 Enter mail, end with &ldquo;.&rdquo;. on a line by itself<br>
                C: Do you like ketchup?<br>
                C: How about pickles?<br>
                C: .<br>
                S: 250 Message accepted for delivery<br>
                C: QUIT<br>
                S: 221 hamburger.edu closing connection<br>
            </tt>
            </div>
        </center>
    </div>
    </section>

    <section>
    <h1>Experimente uma Interação SMTP Você Mesmo</h1>
    <div class="slideContent">
        <ul>
            <li><tt>telnet servername 25</tt></li>
            <li>Espere uma resposta 220 do servidor.</li>
            <li>Digite comandos <tt>HELO, MAIL FROM, RCPT TO, DATA, QUIT</tt>.</li>
        </ul>
        <br>
        <br>
        <center>
            <span class="alert">Permite que você envie e-mail sem usar um cliente.</span>
        </center>
    </div>
    </section>

    <section>
    <h1>SMTP: Útimos Comentários</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li>SMTP utiliza conexões persistentes.</li>
                <li>SMTP requer que mensagem seja composta apenas de caracteres ASCII de 7 bits.</li>
                <li>Servidor utiliza <tt>CRLF.CRLF</tt> para determinar o fim da mensagem.</li>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <ul>
                <li><b>Comparação com o HTTP:</b>
                <ul>
                    <li>HTTP: <i>pull</i>.</li>
                    <li>SMTP: <i>push</i>.</li>
                    <li>Ambos têm mensagens em ASCII, códigos de <i>status</i>.</li>
                    <li>HTTP: cada objeto encapsulado em sua própria mensagem de resposta.</li>
                    <li>SMTP: múltiplos objetos enviados em mensagem de múltiplas partes.</li>
                </ul></li>
            </ul>
        </div>
    </div>
    </section>

    <section>
    <h1>Formato da Mensagem de E-mail</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li>SMTP: protocolo para troca de mensagens de e-mail.</li>
                <li>RFC 822: padrão para formato das mensagens.
                <ul>
                    <li>Linhas de cabeçalho, <i>e.g.</i>:
                    <ul>
                        <li><tt>To:</tt></li>
                        <li><tt>From:</tt></li>
                        <li><tt>Subject:</tt></li>
                        <li><span class="alert">Diferentes dos comandos <tt>MAIL FROM, RCPT TO</tt> do SMTP!</span></li>
                    </ul></li>
                    <li>Corpo: a &ldquo;mensagem em si&rdquo;.
                    <ul>
                        <li>Apenas caracteres ASCII.</li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
        <div class="column" style="width: 50%;">
            <br>
            <br>
            <center>
                <img src="imagens/EmailFormato.svg" style="width: 70%;"/>
            </center>
        </div>
    </div>
    </section>

    <section>
    <h1>Protocolos de Acesso a E-mails</h1>
    <div class="slideContent">
        <center>
            <img src="imagens/EmailAcesso.svg" style="width: 75%;"/>
        </center>
        <br>
        <ul>
            <li><span class="alert">SMTP:</span> entrega mensagem ao servidor do destinatário.</li>
            <li>Protocolo de acesso de e-mail: destinatário obtém suas mensagens do seu servidor.
            <ul>
                <li><span class="alert">POP:</span> <i>Post Office Protocol</i> [RFC 1939]: autorização, <i>download</i>.</li>
                <li><span class="alert">IMAP:</span> <i>Internet Mail Access Protocol</i> [RFC 1730]: mais funcionalidades, incluindo manipulação de mensagens armazenadas no servidor.</li>
                <li><span class="alert">HTTP:</span> gmail, hotmail, Yahoo! Mail, etc.</li>
            </ul></li>
        </ul>
    </div>
    </section>

    <section>
    <h1>O Protocolo POP3</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
            <ul>
                <li><b>Fase de autorização:</b>
                <ul>
                    <li>Comandos do cliente:
                    <ul>
                      <li><b>user:</b> declara o nome do usuário.</li>
                      <li><b>pass:</b> senha.</li>
                    </ul>Servidor responde:
                    <ul>
                      <li><b>+OK</b></li>
                      <li><b>-ERR</b></li>
                    </ul></li>
                </ul></li>
                <li><b>Fase de transações:</b>
                <ul>
                    <li>Cliente:
                    <ul>
                      <li><b>list:</b> lista números das mensagens.</li>
                      <li><b>retr:</b> obtém mensagem por número.</li>
                      <li><b>dele:</b> apaga mensagem.</li>
                      <li><b>quit:</b> encerra comunicação.</li>
                    </ul></li>
                </ul></li>
            </ul>
        </div>
				<div class="column" style="width: 50%;">
				    <img src="imagens/POP3.svg" style="width: 95%;"/>
				</div>
    </div>
    </section>

		</section>
    <section>
    <h1>POP3 (Mais) e IMAP</h1>
    <div class="slideContent">
        <div class="column" style="width: 50%;">
						<ul>
						  <li><b>Mais sobre o POP3:</b>
						  <ul>
						    <li>Exemplo anterior usa POP3 no modo &ldquo;download and delete&rdquo;.</li>
						    <li>Mensagens são baixadas para <i>host</i> do Bob e apagadas do servidor.</li>
						    <li>Há também o modo &ldquo;download and keep&rdquo;: cópias são deixadas no servidor.</li>
						    <li>POP3 é <i>stateless</i> entre sessões.</li>
						  </ul></li>
						</ul>
        </div>
        <div class="column" style="width: 50%;">
						<ul>
						  <li><b>IMAP:</b>
						  <ul>
						    <li>Mantém mensagens apenas no servidor.</li>
						    <li>Permite ao usuário organizar mensagens em pastas.</li>
						    <li>Mantém estado entre sessões do usuário.
						    <ul>
						      <li>Nomes de pastas e mapeamentos de mensagens para pastas.</li>
						    </ul></li>
						  </ul></li>
						</ul>
        </div>
    </div>
    </section>

		<section class="secao">
		<div class="slideContent">
			Aplicações P2P
		</div>
		</section>

		<section>
		<h1>Arquitetura P2P Pura</h1>
		<div class="slideContent">
			<div class="column" style="width: 50%;">
				<br>
				<br>
				<ul>
					<li>Não há servidor sempre ligado.</li>
					<li>Sistemas finais arbitrários se comunicam diretamente.</li>
					<li>Pares se conectam à rede P2P de forma intermitente, podem trocar de endereço IP.</li>
					<li><b>Exemplos:</b>
					<ul>
						<li>Distribuição de arquivos (<i>e.g.</i>, BitTorrent).</li>
						<li><i>Streaming</i> (<i>e.g.</i>, KanKan).</li>
						<li>VoIP (<i>e.g.</i>, Skype).</li>
					</ul></li>
				</ul>
			</div>
			<div class="column" style="width: 50%;">
				<center>
					<img src="imagens/P2PArquitetura.svg" style="width: 70%;"/>
				</center>
			</div>
		</div>
		</section>

		<section>
		<h1>Distribuição de Arquivos: Cliente&mdash;Servidor <i>vs.</i> P2P</h1>
		<div class="slideContent">
			<ul>
				<li><span class="alert">Pergunta:</span> quanto tempo é necessário para distribuir um arquivo (tamanho F) de um servidor para N clientes?
				<ul>
					<li>Capacidades de <i>download/upload</i> dos clientes é um recurso limitado.</li>
				</ul></li>
			</ul>
			<br>
			<center>
				<img src="imagens/P2PvsClienteServidor.svg" style="width: 80%;"/>
			</center>
		</div>
		</section>

		<section>
		<h1>Distribuição de Arquivos: Cliente&mdash;Servidor</h1>
		<div class="slideContent">
			<div style="height: 470px;">
				<div class="column" style="width: 60%;">
					<ul>
						<li><b>Transmissão pelo servidor:</b> precisa enviar (<i>upload</i>) <span class="alert">sequencialmente</span> N cópias do arquivo.
						<ul>
							<li>Tempo para enviar uma cópia: <span class="math inline">\(\frac{F}{u_s}\)</span>.</li>
							<li>Tempo para enviar N cópias: <span class="math inline">\(\frac{N\cdot F}{u_s}\)</span>.</li>
						</ul></li>
						<li><b>Cliente:</b> cada cliente precisa receber (<i>download</i>) sua cópia do arquivo.
						<ul>
							<li><span class="math inline">\(d_{min} = \)</span> capacidade de <i>download</i> mínima entre todos os clientes.</li>
							<li>Tempo máximo de <i>download</i> entre os clientes: <span class="math inline">\(\frac{F}{d_{min}}\)</span>.</li>
						</ul></li>
					</ul>
				</div>
				<div class="column" style="width: 40%;">
					<center>
						<img src="imagens/P2PvsClienteServidor.svg" style="width: 90%;"/>
					</center>
				</div>
			</div>
			<center>
			<div style="width: 80%; padding: 5px; border: 2px solid #4a4; height: 160px;">
				<div class="column" style="width: 50%;">
					<br>
					Tempo para distribuir arquivo de tamanho F para N clientes utilizando abordagem Cliente&mdash;Servidor
				</div>
				<div class="column" style="width: 50%;">
					<br>
					<center>
						<span class="math inline">\(D_{C-S} = max\left\{\frac{N\cdot F}{u{s}}, \frac{F}{d_{min}}\right\}\)</span>
					</center>
				</div>
			</div>
			</center>
		</div>
		</section>

		<section>
		<h1>Distribuição de Arquivos: P2P</h1>
		<div class="slideContent">
			<div style="height: 300px;">
				<div class="column" style="width: 60%;">
					<ul>
						<li><b>Transmissão pelo servidor:</b> precisa enviar (<i>upload</i>) <span class="alert">ao menos uma cópia</span>.
						<ul>
							<li>Tempo para enviar uma cópia: <span class="math inline">\(\frac{F}{u_s}\)</span>.</li>
						</ul></li>
						<li><b>Cliente:</b> cada cliente precisa receber (<i>download</i>) sua cópia do arquivo.
						<ul>
							<li>Tempo máximo de <i>download</i> entre os clientes: <span class="math inline">\(\frac{F}{d_{min}}\)</span>.</li>
						</ul></li>
					</ul>
				</div>
				<div class="column" style="width: 40%;">
					<center>
						<img src="imagens/P2PvsClienteServidor.svg" style="width: 90%;"/>
					</center>
				</div>
			</div>
			<br>
			<ul>
				<li><b>Clientes:</b> em conjunto, clientes farão <i>download</i> de <span class="math inline">\(N\cdot F\)</span> bits.
				<ul>
					<li>Taxa máxima de <i>upload</i> (que limita taxa de <i>download</i>) é <span class="math inline">\(u_{s} + \sum{u_i}\)</span>.</li>
				</ul></li>
			</ul>

			<center>
			<div style="width: 80%; padding: 5px; border: 2px solid #4a4; height: 150px;">
				<div class="column" style="width: 50%;">
					<br>
					Tempo para distribuir arquivo de tamanho F para N clientes utilizando abordagem P2P
				</div>
				<div class="column" style="width: 50%;">
					<br>
					<center>
						<span class="math inline">\(D_{P2P} = max\left\{\frac{F}{u{s}}, \frac{F}{d_{min}}, \frac{N\cdot F}{u_{s} + \sum{u_i}}\right\}\)</span>
					</center>
				</div>
			</div>
			</center>
		</div>
		</section>

		<section>
		<h1>Distribuição de Arquivos: Comparação (I)</h1>
		<div class="slideContent">
			<ul>
				<li>Caso Cliente&mdash;Servidor:
				<ul>
					<center>
						<span class="math inline">\(D_{C-S} = max\left\{\frac{N\cdot F}{u{s}}, \frac{F}{d_{min}}\right\}\)</span>
					</center>
					<li>Demanda cresce linearmente com N.</li>
					<li>Capacidade do servidor é fixa.</li>
				</ul></li>
				<li>Caso P2P:
				<ul>
					<center>
						<span class="math inline">\(D_{P2P} = max\left\{\frac{F}{u{s}}, \frac{F}{d_{min}}, \frac{N\cdot F}{u_{s} + \sum{u_i}}\right\}\)</span>
					</center>
					<li>Demanda aumenta linearmente com N.</li>
					<li>Mas também a capacidade de <i>upload</i>.</li>
					<li>Resultado: <span class="alert">tempo de distribuição cresce, mas de forma mais escalável.</span></li>
				</ul></li>
			</ul>
		</div>
		</section>

		<section>
		<h1>Distribuição de Arquivos: Comparação (II)</h1>
		<div class="slideContent">
			<ul>
				<li>Exemplo numérico:
				<ul>
					<li><span class="math inline">\(\frac{F}{u} = 1\)</span> hora.</li>
					<li>Capacidade de <i>upload</i> do servidor 10x maior que dos clientes.</li>
					<li><span class="math inline">\(d_{min} \ge u{s}\)</span>.</li>
				</ul></li>
			</ul>
			<center>
				<img src="imagens/P2PGrafico.svg" style="width: 50%;"/>
			</center>
		</div>
		</section>

		<section>
		<h1>Distribuição de Arquivos P2P: Exemplo do BitTorrent (I)</h1>
		<div class="slideContent">
			<ul>
				<li>Arquivo dividio em pedaços de (normalmente) 256KB.</li>
				<li>Pares no torrent enviam/recebem pedaços do arquivo.</li>
			</ul>

			<center>
				<img src="imagens/BitTorrent.svg" style="width: 75%;"/>
			</center>
		</div>
		</section>

		<section>
		<h1>Distribuição de Arquivos P2P: Exemplo do BitTorrent (II)</h1>
		<div class="slideContent">
			<div style="height: 270px;">
				<div class="column" style="width: 50%;">
					<ul>
						<li>Par se junta ao torrent:
						<ul>
							<li>Não possui nenhum pedaço, mas os acumulará com o tempo de outros pares.</li>
							<li>Se registra com o <i>tracker</i> para obter uma lista de pares, se conecta a um subconjunto dos pares (&ldquo;vizinhos&rdquo;).</li>
						</ul></li>
					</ul>
				</div>
				<div class="column" style="width: 50%;">
					<center>
						<img src="imagens/BitTorrentSimplificado.svg" style="width: 70%;"/>
					</center>
				</div>
			</div>
			<ul>
				<li>Enquanto baixa, pares fazem <i>upload</i> para outros pares.</li>
				<li>Par pode alterar os pares com que troca pedaços.</li>
				<li><span class="alert">Churn:</span> pares vem e vão.</li>
				<li>Quando um par tem o arquivo inteiro (todos os pedaços), ele pode (de forma egoísta) sair ou (de forma autruísta) ficar no torrent.</li>
			</ul>
		</div>
		</section>

		<section>
		<h1>BitTorrent: Requisitando, Enviando Pedaços do Arquivo</h1>
		<div class="slideContent">
			<div class="column" style="width: 45%;">
				<ul>
					<li><b>Requisitando pedaços</b>:
					<ul>
						<li>Em um dado momento, diferentes pares possuem diferentes subconjuntos dos pedaços do arquivo.</li>
						<li>Periodicamente, um par pede aos outros pares uma lista dos pedaços que possuem.</li>
						<li>Par então requisita pedaços que não possui aos pares, começando pelos mais raros.</li>
					</ul></li>
				</ul>
			</div>
			<div class="column" style="width: 55%;">
				<ul>
					<li><b>Enviando pedaços: <i>tit-for-tat</i></b>.
					<ul>
						<li>Par envia pedaços aos 4 pares que atualmente o enviam pedaços na taxa mais alta.
						<ul>
							<li>Outros pares sofrem <i>choking</i> (<i>i.e.</i>, não recebem pedaços).</li>
							<li>Uma nova avaliação dos 4 melhores pares é feita a cada 10 segundos.</li>
						</ul></li>
						<li>A cada 30 segundos: par seleciona aleatoriamente outro par, começa a enviar pedaços.
						<ul>
							<li><i>Optimistically unchoke</i>.</li>
							<li>Dá oportunidade de pares demonstrarem que são bons <i>uploaders</i>.</li>
							<li>Par escolhido de forma aleatória pode se tornar um dos 4 melhores.</li>
						</ul></li>
					</ul></li>
				</ul>
			</div>
		</div>
		</section>

		<section>
		<h1>BitTorrent: Tit-For-Tat</h1>
		<div class="slideContent">
			<center>
				<img src="imagens/BitTorrentTitForTat.svg" style="width: 70%;"/>
			</center>
		</div>
		</section>

	<!-- {{{{ dzslides core
	#
	#
	#     __  __  __       .  __   ___  __
	#    |  \  / /__` |    | |  \ |__  /__`
	#    |__/ /_ .__/ |___ | |__/ |___ .__/ core :€
	#
	#
	# The following block of code is not supposed to be edited.
	# But if you want to change the behavior of these slides,
	# feel free to hack it!
	#
	-->

    <!-- More CSS -->
	<link href='../template/css/slides.css' id="slides" rel='stylesheet' type='text/css'>
	<link href='../template/css/presentationSpecific2.css' id="presentationSpecific2" rel='stylesheet' type='text/css'>

    <!-- More Javascript -->
	<script type="text/javascript" src="../template/js/dz.js"></script>

	<!-- More CSS -->
	<link href='../template/css/notesSpecific.css' id="notesSpecific" rel='stylesheet' type='text/css'>
	<link href='../template/css/printSpecific.css' id="printSpecific" rel='stylesheet' type='text/css'>
</body>
</html>
