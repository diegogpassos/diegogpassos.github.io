<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Eficiência do Protocolo ALOHA</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="análise-do-aloha-baseado-em-slots">Análise do ALOHA Baseado em <em>Slots</em></h1>
<p>Dentre os protocolos de acesso ao meio pertencentes à família de acesso aleatório — também chamados de <em>baseados em contenção</em> —, o protocolo ALOHA é um dos mais (senão o mais) antigo. Mesmo assim, esse protocolo ainda hoje é considere importante, não só por razões históricas, mas pelo seu emprego em determinadas tecnologias de comunicação modernas. Um exemplo disso é o uso do ALOHA como protocolo de acesso ao meio na tecnologia LoRaWAN, bastante empregada em soluções de IoT (<em>Internet of Things</em>, ou Internet das Coisas).</p>
<p>O protocolo ALOHA foi projetado como parte da ALOHAnet, uma rede de comunicação sem fio criada pela Universidade do Havaí com o objetivo de prover conectividade de usuários localizados nas diversas ilhas do arquipélago a um servidor compartilhado localizado no campus principal da universidade. A ALOHAnet entrou em operação no início da década de 1970 e é amplamente considerada a primeira demonstração pública de uma rede sem fio baseada em comutação de pacotes. Dessa forma, a ALOHAnet pode ser considerada uma precursora de tecnologias populares atualmente, como o Wi-Fi e o LTE.</p>
<p>O protocolo de acesso ao meio ALOHA sofreu alterações ao longo do período de desenvolvimento e operação da ALOHAnet. Em particular, hoje geralmente faz-se a distinção entre o <em>ALOHA Puro</em> e o <em>ALOHA baseado em Slots de Tempo</em> (também denominado <em>Slotted ALOHA</em>). Cronologicamente, o ALOHA Puro foi a primeira vertente. Posteriormente, o <em>Slotted ALOHA</em> foi proposto como uma versão melhorada — embora com maior complexidade de implementação — do ALOHA Puro.</p>
<p>Nesse material, estudaremos em certo nível de detalhe o funcionamento do ALOHA, com especial atenção à sua eficiência em gerenciar o uso do meio de transmissão. Em particular, focaremos majoritariamente na versão baseada em <em>slots</em>, por apresentar melhor desempenho e uma análise mais simples. Ao longo desse estudo, veremos ainda uma série de elementos e conceitos do ALOHA que se aplicam a outros protocolos de acesso aleatório.</p>
<h2 id="funcionamento-do-aloha-baseado-em-slots">Funcionamento do ALOHA Baseado em <em>Slots</em></h2>
<p>Como o nome sugere, no <em>Slotted ALOHA</em> o tempo é discretizado em <em>slots</em>, ou janelas de tempo, de duração fixa. Cada <em>slot</em> é suficiente para a transmissão de um único quadro (por simplicidade, vamos assumir aqui que todos os quadros possuem o mesmo tamanho). Nós sempre sabem quando começam e terminam os <em>slots</em>, e transmissões sempre são iniciadas no início de <em>slots</em>. Em outras palavras: se um nó decide transmitir um quadro, mas encontra-se no meio do <em>slot</em> atual, ele necessariamente aguardará até que um novo <em>slot</em> se inicie para começar sua transmissão. Por fim, assumiremos também que se dois ou mais nós transmitem em um mesmo <em>slot</em>, sempre ocorre colisão e todos os nós envolvidos são capazes de detectá-la (note que ainda não entramos no mérito de como essa detecção é realizada).</p>
<p>Dadas essas características e hipóteses, o funcionamento do <em>Slotted</em> Aloha é bastante simples. Quando um nó decide enviar um quadro, ele simplesmente aguarda o início do próximo <em>slot</em> e realiza a transmissão, independentemente de quaisquer outros fatores. Essa transmissão pode ter dois resultados:</p>
<ul>
<li><p><strong>Ausência de colisão</strong>: transmissor considera a transmissão do quadro correspondente encerrada. Se houver outro quadro a ser transmitido, ele pode iniciar a nova transmissão no início do próximo <em>slot</em>.</p></li>
<li><p><strong>Colisão</strong>: nesse caso, o nó detectará que a colisão ocorreu e tentará <strong>retransmitir</strong> o quadro nos <em>slots</em> subsequentes como forma de recuperação.</p></li>
</ul>
<p>Ao contrário da tentativa original de transmissão de um quadro, que sempre ocorre no início do próximo <em>slot</em> de tempo, em uma retransmissão, um nó pode demorar vários <em>slots</em> até realizar a próxima tentativa. A cada novo <em>slot</em>, o nó decide aleatoriamente se realizará a retransmissão naquele <em>slot</em> ou não. Mais especificamente, o <em>Slotted ALOHA</em> utiliza um parâmetro <span class="math inline">\(p\)</span> que determina a probabilidade de um nó decidir realizar a retransmissão no próximo <em>slot</em>. Note, portanto, que nas tentativas de retransmissão o nó pode <strong>adiar o acesso ao meio</strong> — um mecanismo conhecido como <strong><em>backoff</em></strong>.</p>
<p>Mas por que não fazer simplesmente com que os nós tentem a retransmissão no próximo <em>slot</em> de tempo em caso de colisão? Por que é necessário — ou, ao menos, vantajoso — introduzir esse <em>backoff</em> aleatório? Para responder essas perguntas, consideremos um protocolo alternativo em que, em caso de colisão, o nó sempre realiza a tentativa de retransmissão no início do <em>slot</em> subsequente. Repare que, por definição, uma colisão envolve dois ou mais transmissores. Logo, todos os — múltiplos — transmissores que tiveram seus quadros colididos em um dado <em>slot</em> realizarão retransmissões no <em>slot</em> seguinte. Em outras palavras, tais retransmissões se darão, necessariamente, simultaneamente. Como consequência, as retransmissões também falharão por conta de uma nova colisão.</p>
<p>Repare que quando uma colisão ocorre, ela implicitamente introduz uma <strong>sincronização</strong> nos estados dos nós envolvidos, no sentido de que todos eles terão acabado de ter seus quadros perdidos por colisão, necessitando, portanto, realizar suas respectivas retransmissões. Se todos os nós executassem as mesmas ações determinísticas nesse momento — por exemplo, tentar retransmitir imediatamente ou tentar retransmitir daqui a 10 <em>slots</em> de tempo — essa sincronização levaria a uma nova colisão, fazendo com que os transmissores jamais conseguissem se recuperar. É justamente para quebrar esse sincronismo que o <em>backoff</em> aleatório serve: o adiamento da retransmissão por um nó dá aos demais a oportunidade de transmitirem (sozinhos) seus quadros, enquanto a componente aleatória reduz a probabilidade de que nós diferentes agendem suas retransmissões para um mesmo <em>slot</em> de tempo novamente.</p>
<h2 id="análise-qualitativa">Análise Qualitativa</h2>
<p>Embora simples, o <em>Slotted ALOHA</em> tem uma série de características positivas. Por exemplo, ele é altamente <strong>eficiente sob baixas cargas</strong>. Em um caso extremo, se apenas um transmissor possui dados a transmitir, ele obtém uma utilização de 100% do enlace já que, sem concorrência, não há colisões e, portanto, não há <em>backoffs</em>. Além disso, o protocolo é altamente <strong>descentralizado</strong> em termos das decisões tomadas por cada nó: um transmissor decide ou não acessar o meio com base apenas em informações locais. Por fim, a implantação do algoritmo em si é <strong>simples</strong>, dependendo apenas da capacidade de geração de números pseudo-aleatórios, algo relativamente comum em sistemas computacionais modernos.</p>
<p>Por outro lado, há também pontos negativos. Em primeiro lugar, há a <strong>possibilidade de colisões</strong>, especialmente sob altas cargas, o que introduz desperdício de tempo de uso do enlace, reduzindo a eficiência do protocolo. Além disso, em caso de retransmissões, <em>slots</em> podem ficar <strong>ociosos</strong>, mesmo que haja dados a serem transmitidos no enlace (isto é, todos os transmissores podem abrir mão de transmitir em um dado <em>slot</em> como parte de seus <em>backoffs</em>). Em termos de complexidade de implementação, a discretização do tempo em <em>slots</em> comuns a todos os transmissores demanda um certo grau de <strong>sincronização de relógio</strong>. Por fim, note que ainda que um nó tenha a capacidade de detectar uma colisão <strong>durante a transmissão do quadro</strong>, todo o <em>slot</em> será desperdiçado em caso de colisão, porque novas transmissões só podem ser começadas no início do próximo <em>slot</em>.</p>
<h2 id="eficiência">Eficiência</h2>
<p>Voltemos um instante à eficiência do <em>Slotted ALOHA</em>. Dada sua operação simples e considerando algumas simplificações razoáveis, é possível modelá-la matematicamente. Para isso, definiremos a eficiência do protocolo como a fração de <em>slots</em> <strong>bem sucedidos a longo prazo</strong>. Aqui, <em>bem sucedidos</em> significa que <strong>houve uma transmissão e que não houve colisão</strong>. Por outro lado, <em>a longo prazo</em> quer dizer que estamos considerando uma sequência arbitrariamente longa de <em>slots</em>. Para essa análise, consideraremos que existem <span class="math inline">\(N\)</span> transmissores <em>ativos</em>. Em outras palavras, esses <span class="math inline">\(N\)</span> transmissores sempre possuem quadros a enviar<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, enquanto outros nunca transmitem.</p>
<p>Da descrição do funcionamento do <em>Slotted ALOHA</em>, pode-se inferir que o protocolo possui basicamente dois estados referentes à transmissão de quadros: ou o nó está no processo de realizar a transmissão original do quadro, ou se encontra tentando realizar uma retransmissão. Note que o comportamento de um nó nesses dois estados é diferente, já que, no primeiro, a transmissão sempre é realizada no próximo <em>slot</em>, enquanto, no segundo, a transmissão é realizada no próximo <em>slot</em> com probabilidade <span class="math inline">\(p\)</span>. Para simplificar a análise, consideraremos apenas o segundo caso<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Em resumo: todos os <span class="math inline">\(N\)</span> nós possuem quadros a transmitir em todo <em>slot</em> e o farão com probabilidade <span class="math inline">\(p\)</span>.</p>
<p>O primeiro passo nessa análise é determinar a probabilidade de que um <em>slot</em> seja bem sucedido. Isso ocorre quando exatamente um nó transmite e os outros <span class="math inline">\(N-1\)</span> não. A probabilidade de que um dado nó transmita sozinho é dada por:</p>
<p><span class="math display">\[p\cdot \underbrace{(1-p)\cdot (1-p)\cdot \dots\cdot (1-p)}_{(N-1) \text{ vezes}} = p\cdot(1-p)^{(N-1)}\]</span></p>
<p>Note, entretanto, que como há <span class="math inline">\(N\)</span> transmissores ativos, qualquer um deles pode ser o transmissor bem sucedido no <em>slot</em> em questão. Logo, a probabilidade de que um dado <em>slot</em> seja bem sucedido é:</p>
<p><span class="math display">\[P(\text{Slot bem sucedido}) = N\cdot p\cdot(1-p)^{(N-1)}\]</span></p>
<p>A longo prazo, esse valor corresponde à eficiência do protocolo, conforme definido anteriormente:</p>
<p><span class="math display">\[\text{Efic}(p) = P(\text{Slot bem sucedido}) = N\cdot p\cdot(1-p)^{(N-1)}\]</span></p>
<p>Repare que a eficiência é, portanto, uma função de <span class="math inline">\(N\)</span> (número de transmissores ativos) e <span class="math inline">\(p\)</span> (probabilidade de retransmissão em um dado <em>slot</em>). O valor <span class="math inline">\(N\)</span> é uma característica do enlace, mas <span class="math inline">\(p\)</span> pode, a princípio, ser configurado. Uma pergunta natural, portanto, é: <strong>existe algum valor ótimo</strong> de <span class="math inline">\(p\)</span>?</p>
<p>A resposta para essa questão é “sim”. Independentemente do número de transmissores ativos, a função <span class="math inline">\(\text{Efic}(p)\)</span> possui exatamente um ponto máximo, como pode ser visto na figura a seguir:</p>
<p><img src="imagens/aloha_effic_param.png" /></p>
<p>Esse gráfico mostra o comportamento da função <span class="math inline">\(\text{Efic}(p)\)</span> para diversos valores do número de transmissores <span class="math inline">\(N\)</span>. Aumentar o valor de <span class="math inline">\(N\)</span> faz com que a curva seja “empurrada” para a esquerda do gráfico, mas, para todos os valores de <span class="math inline">\(N\)</span>, a curva apresenta o mesmo comportamento básico: a eficiência inicialmente aumenta com o aumento de <span class="math inline">\(p\)</span>, alcança um valor máximo e, a partir dali, começa a cair.</p>
<p>Determinar o ponto em que esse máximo ocorre é simples. Bastando calcular a primeira derivada da função em relação ao parâmetro <span class="math inline">\(p\)</span> e descobrir onde ela se torna nula:</p>
<p><span class="math display">\[\text{Efic}^\prime(p) = N\cdot (1-p)^{(N-1)} - N\cdot(N-1)\cdot(1-p)^{(N-2)}\]</span></p>
<p>Logo, queremos determinar <span class="math inline">\(p\)</span> tal que:</p>
<p><span class="math display">\[N\cdot (1-p)^{(N-1)} - N\cdot(N-1)\cdot(1-p)^{(N-2)} = 0\]</span></p>
<p>Assumindo que <span class="math inline">\(N \not= 0\)</span> e <span class="math inline">\((1-p) \not= 0\)</span>:</p>
<p><span class="math display">\[(1-p)-(N-1)\cdot p = 0\]</span> <span class="math display">\[p = \frac{1}{N}\]</span></p>
<p>Isso indica que o valor ótimo de <span class="math inline">\(p\)</span> depende do número de transmissores ativos no enlace, o que faz sentido se considerarmos que, com mais transmissores ativos, cada transmissor deve ser mais conservador nas suas tentativas de acesso ao meio. Isso também é consistente com o gráfico anterior, que mostrava o ponto de máximo da função se aproximando de <span class="math inline">\(p = 0\)</span> à medida que aumentávamos o valor de <span class="math inline">\(N\)</span>.</p>
<p>Com base nesse valor, podemos também calcular a eficiência máxima em função de <span class="math inline">\(N\)</span>. Para isso, basta substituirmos o valor ótimo de <span class="math inline">\(p\)</span> em <span class="math inline">\(\text{Efic}(p)\)</span>:</p>
<p><span class="math display">\[\text{MaxEfic}(N) = \text{Efic}\left(\frac{1}{N}\right) = N\cdot\frac{1}{N}\cdot\left(1 - \frac{1}{N}\right)^{(N-1)}\]</span> <span class="math display">\[\text{MaxEfic}(N) = \left(1 - \frac{1}{N}\right)^{(N-1)}\]</span></p>
<p>Assim como fizemos com <span class="math inline">\(\text{Efic}(p)\)</span>, podemos plotar a função <span class="math inline">\(\text{MaxEfic}(N)\)</span>:</p>
<p><img src="imagens/aloha_effic_max.png" /></p>
<p>Seja pela inspeção da expressão ou desse gráfico, podemos notar que a função é <strong>decrescente</strong>. Ou seja, <strong>quanto mais transmissores, menor é a eficiência máxima alcançável</strong>. De fato, podemos analisar mais concretamente o que acontece em um enlace com um “grande número de transmissores” calculando o limite dessa função a medida que <span class="math inline">\(N\to\infty\)</span>:</p>
<p><span class="math display">\[\lim_{N \to \infty} \text{MaxEfic}(N) = \lim_{N \to \infty} \left(1 - \frac{1}{N}\right)^{(N-1)} = \frac{1}{e} \approx 0,367\]</span></p>
<p>Em resumo, tudo isso significa que a eficiência do <em>Slotted ALOHA</em> — que já é baixa para poucos transmissores ativos (<em>e.g.</em>, 50% para <span class="math inline">\(N = 2\)</span>) — cai rapidamente e tende a pouco mais de 36% à medida que mais transmissores se tornam ativos. Repare ainda que esses valores de eficiência pressupõem o uso do valor ótimo para a probabilidade <span class="math inline">\(p\)</span>. Conclui-se, portanto, que a eficiência do <em>Slotted ALOHA</em> sob altas cargas é muito ruim.</p>
<h2 id="aloha-puro">ALOHA Puro</h2>
<p>Lembre-se, no entanto, que o <em>Slotted</em> ALOHA é uma otimização do ALOHA Puro. Logo, deve-se esperar que o ALOHA Puro tenha eficiência ainda mais baixa! O ALOHA Puro tinha funcionamento ainda mais simples que a versão <em>Slotted</em>. Em particular, não há qualquer sincronização entre os nós, tampouco o conceito de <em>slots</em> de tempo. Quando um nó possui um quadro a transmitir, ele simplesmente efetua a transmissão imediatamente. Em caso de colisão, o nó sorteia um valor de <em>backoff</em> aleatório de um determinado intervalo. Ao final do período de <em>backoff</em>, o nó realiza a retransmissão, independentemente de quaisquer outros fatores.</p>
<p>Repare que há uma diferença na forma de aplicação do <em>backoff</em> nas duas versões do ALOHA: enquanto na versão <em>Slotted</em>, o tempo de backoff é uma consequência sucessivas decisões de não retransmissão em cada <em>slot</em>, a versão pura já sorteia exatamente o valor que será aguardado. Até certo ponto, as duas formas resultam em comportamentos semelhantes, embora a abordagem utilizada pelo ALOHA puro seja mais comum nos protocolos baseados em contenção mais modernos.</p>
<p>Em relação à eficiência, não faremos aqui uma análise matemática do ALOHA Puro, como fizemos para a versão <em>Slotted</em>. Mas, intuitivamente, note que há <strong>mais possibilidades de colisão</strong> na versão pura: enquanto no <em>Slotted</em> ALOHA, só podem ocorrer colisões entre quadros que começam a ser transmitidos ao mesmo tempo (<em>i.e.</em>, no início do mesmo slot), a falta de sincronização do ALOHA Puro faz com que um quadro possa agora colidir com outro cuja transmissão foi iniciada <strong>antes ou depois</strong> da sua. De fato, esse aumento da probabilidade de colisão acaba levando a uma piora da eficiência: uma modelagem similar à feita para o <em>Slotted</em> ALOHA revela que, para altas cargas, a eficiência do ALOHA Puro tende a apenas 18% à medida que o número de transmissores ativos cresce.</p>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>É comum dizermos que esses transmissores possuem um <em>backlog infinito</em>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>Repare que em uma situação de alta carga essa hipótese se torna mais razoável, já que colisões se tornam mais comuns, fazendo com que a maioria das transmissões sejam retransmissões de quadros perdidos.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
